# ExcelHub
在制造业的企业实践中，使用最广的记录数据的工具仍是Excel电子表格，在企业进行智能制造升级转型中，就势必需要将历史的Excel数据，存储到数据库中，以便数据的管理和分析。但这些Excel数据可以说格式和数据千差万别，就需要有一种有效的工具来流畅的进行数据的迁移。同时，限于信息化和计算机技术掌握的水平，大量制造业工人仍旧习惯或愿意使用Excel作为日常数据的录入工具，所以在升级转型中，仍需要考虑某些不能使用智能化机器采集的数据录入问题，一种有效的方式是保留Excel格式录入，录入完成后通过简单操作就可以导入数据库中。ExcelHub就可以解决Excel文件的数据的导入和日常数据录入
           
## 1、Excel数据导入到数据库
要将Excel数据导入到数据库，可以分为几个步骤：

1. 加载Excel文件，并对操作的上下文进行保存，以便下次打开工具继续操作
2. 对Excel文件数据导入进行配置，包括表格化配置和数据库表的配置两个主要内容。
3. 对数据进行导入预览，并进行导入操作。

### 1.1 Excel文件的加载和管理
点击右边的 Excel文件菜单项，对打开上次操作的Excel文件，如果想打开其他Excel文件，可以点击文件菜单中的打开按钮，或点击从库里选择按钮。

![acb65f4238346401a816805cb34b12bc.png](./ExcelHub/ScreenShots/ConfigDb1.png)

**原则：要对操作过的文件有详细的保存和记录**
当选择从库里打开按钮，会弹出如下界面，双击列表里
同时存储在上面这张表中，以便可以从历史记录中取出来，进行删除等操作。界面如下设计

![23b209aeb5a30d3e248d27e4da87cd71.png](./ExcelHub/ScreenShots/ExcelHistory.png)


用户可以通过对列表项进行双击操作调入，也可以对有的无用的记录进行删除。

### 1.2 Excel数据导入的配置
我们假定 **从在工具里打开Excel文件到把里面数据导入到数据库** 这一过程叫做**一次数据导入操作**，导入配置也是针对一次数据导入操作进行，一个Excel文件可以包括一个或多个Sheet页。导入配置包括确定数据区，确定操作的Sheet页，要导入的目标数据库、对应的数据库表，对应的字段匹配以及相关的存储过程等。配置是通过文件 oper_id 为主键进行标识。主要分为三方面的配置：

* 表格化相关配置
* 数据库相关配置
* 转化适配器配置

#### 1.2.1 表格化配置
本工具是通过Excel的表(Table)来确定需要被操作的数据区，需要确定数据区的左上角（单元格名称）和右下角（单元格名称）区域。然后需要确定数据区应用的Sheet页，需要假定本次导入操作对 不同Sheet页具有同样的待处理数据区。如果确实需要对该数据文件进行多次导入操作，则需要定义另一次数据导入操作配置。完成了数据区域指定和Sheet页的配置后，即可以进行 标记表的程序自动化操作。界面设计如下：
![de8af06b711274923b9a55830fe78390.png](./ExcelHub/ScreenShots/Tablized.png)


#### 1.2.2 数据库配置
导入数据库时，需要确定导入哪个数据库？哪个表？以及数据区的单元表格与数据库表字段的映射。 这也可以通过配置界面完成。
![69a9f0c653242391f395a3c6ea0d55fa.png](./ExcelHub/ScreenShots/DBTable.png)


#### 1.2.3 配置转换适配器
由于实际情况千差万别，为了适应这种情况，往往不是简单的字段映射这么简单，这也是为什么很多数据导入工具不适用的原因。本工具采用可外挂转换适配器源码的方式解决，这也是本工具一个优点或特色。外挂的源代码可以在本工具进行运行时编译并运行，目前版本支持C#语言。编好代码后，可以通过配置将其纳入本次数据导入范围内。
通过文件打开按钮打开 编写好的CS文件，并另存到特定目录。如果需要也可以存储到数据库中。
![aac4322d77ecb1240d55ef902488a5ed.png](./ExcelHub/ScreenShots/Adapter.png)

### 1.3 Excel数据导入
在进行上面两个步骤后，就可以对数据进行导入数据库的操作了，具体操作如下图所示：
![fcc3a8e85d5916eceb4d89abac2f093d.png](./ExcelHub/ScreenShots/import.png)

点击主界面上的 数据预览 按钮， 会弹出数据预览窗口，该窗体上面会有两个TAB页面，一个是原始数据，一个时处理后数据，此时点击数据整理按钮，系统会对原始数据进行转换，并显示处理后数据，处理后的数据若没有问题， 直接点击 导入数据库按钮，就完成了数据导入工作。
